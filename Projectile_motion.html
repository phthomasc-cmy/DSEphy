<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üöÄ Projectile Motion Master</title>
    
    <!-- MathJax Library to render formulas -->
    <script>
    window.MathJax = {
      tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] }
    };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <style>
        :root {
            --primary: #FF6B6B;
            --secondary: #4ECDC4;
            --dark: #2C3E50;
            --light: #F7FFF7;
            --accent: #FFE66D;
            --col-x: #be2edd; /* Purple for X */
            --col-y: #22a6b3; /* Teal for Y */
            --col-v: #f0932b; /* Orange for Total */
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f0f4f8;
            color: var(--dark);
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0;
            padding: 20px;
        }

        h1 { color: var(--primary); margin-bottom: 5px; text-shadow: 2px 2px 0px var(--accent); }
        .subtitle { color: #666; margin-bottom: 20px; font-style: italic; }

        .container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: center;
            max-width: 1300px;
            width: 100%;
        }

        /* Canvas Area */
        .canvas-wrapper {
            position: relative;
            border: 4px solid var(--dark);
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
            background: linear-gradient(to bottom, #87CEEB 0%, #E0F7FA 80%, #90EE90 80%, #228B22 100%);
            width: 600px;
        }
        
        .scale-indicator {
            position: absolute;
            top: 10px; right: 10px;
            background: rgba(255,255,255,0.8);
            padding: 5px 10px;
            border-radius: 8px;
            font-size: 0.8rem;
            font-weight: bold;
            pointer-events: none;
        }

        canvas { display: block; width: 100%; }

        /* Controls */
        .controls {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
            flex: 1;
            min-width: 250px;
            max-width: 350px;
        }

        .control-group { margin-bottom: 20px; }
        label { font-weight: bold; display: block; margin-bottom: 8px; }

        input[type=range] {
            width: 100%;
            accent-color: var(--primary);
            height: 10px;
            background: #ddd;
            border-radius: 5px;
            outline: none;
        }

        .buttons { display: flex; gap: 10px; }
        button {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: 0.2s;
        }
        button:hover { transform: translateY(-2px); }
        #btn-throw { background-color: var(--primary); color: white; }
        #btn-reset { background-color: var(--secondary); color: white; }

        /* Math & Stats Panel */
        .math-panel {
            display: flex;
            flex-direction: column;
            gap: 15px;
            flex: 1;
            min-width: 300px;
            max-width: 400px;
        }

        .box {
            background: var(--dark);
            color: var(--light);
            padding: 15px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            font-family: 'Courier New', Courier, monospace;
        }

        .box h3 {
            margin-top: 0;
            border-bottom: 1px solid #555;
            padding-bottom: 5px;
            color: var(--accent);
            font-size: 1.1em;
        }

        .math-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 6px;
            font-size: 0.95em;
            align-items: center;
        }

        .sub-group {
            background: rgba(255,255,255,0.1);
            padding: 8px;
            border-radius: 8px;
            margin-top: 10px;
        }

        .formula-container {
            margin-bottom: 15px;
            border-bottom: 1px dashed #555;
            padding-bottom: 10px;
        }

        /* Adjust MathJax font size */
        mjx-container {
            font-size: 110% !important;
            color: #ccc;
        }

        /* Text Colors */
        .c-x { color: var(--col-x); font-weight: bold; }
        .c-y { color: var(--col-y); font-weight: bold; }
        .c-v { color: var(--col-v); font-weight: bold; }
        .c-res { color: var(--accent); font-weight: bold; font-size: 1.1em;}
        
        .emoji-selector { text-align: center; margin-bottom: 15px; }
        .emoji-btn {
            background: none; border: 2px solid transparent;
            font-size: 1.5rem; cursor: pointer; border-radius: 50%;
        }
        .emoji-btn.selected { background-color: var(--accent); transform: scale(1.2); }

    </style>
</head>
<body>

    <h1>üöÄ Projectile Motion Master</h1>
    <div class="subtitle">Velocity Components, Flight Time & Formulas</div>

    <div class="container">
        
        <!-- 1. Controls -->
        <div class="controls">
            <div class="emoji-selector">
                <button class="emoji-btn selected" onclick="selectEmoji('üöÄ')">üöÄ</button>
                <button class="emoji-btn" onclick="selectEmoji('üèÄ')">üèÄ</button>
                <button class="emoji-btn" onclick="selectEmoji('üéπ')">üéπ</button>
                <button class="emoji-btn" onclick="selectEmoji('üëΩ')">üëΩ</button>
            </div>

            <div class="control-group">
                <label>Initial Speed ($v_0$): <span id="val-velocity" class="c-v">50</span> m/s</label>
                <input type="range" id="slider-velocity" min="10" max="150" step="1" value="50">
            </div>

            <div class="control-group">
                <label>Angle ($\theta$): <span id="val-angle" style="color:white; background:var(--dark); padding:2px 6px; border-radius:4px;">45</span>¬∞</label>
                <input type="range" id="slider-angle" min="5" max="90" step="1" value="45">
            </div>

            <div class="buttons">
                <button id="btn-throw" onclick="startSimulation()">üî• THROW</button>
                <button id="btn-reset" onclick="resetSimulation()">üîÑ RESET</button>
            </div>
        </div>

        <!-- 2. Canvas -->
        <div class="canvas-wrapper">
            <canvas id="simCanvas" width="600" height="400"></canvas>
            <div id="zoom-display" class="scale-indicator">Zoom: Auto</div>
        </div>

        <!-- 3. Math Panels -->
        <div class="math-panel">
            
            <!-- Live Data -->
            <div class="box">
                <h3>üìä Live Statistics</h3>
                <div class="math-row">
                    <span>‚è±Ô∏è Current Time ($t$):</span> <span id="stat-time">0.00 s</span>
                </div>
                <div class="math-row">
                    <span>‚ÜîÔ∏è Distance ($x$):</span> <span id="stat-x">0.00 m</span>
                </div>
                <div class="math-row">
                    <span>‚ÜïÔ∏è Height ($y$):</span> <span id="stat-y">0.00 m</span>
                </div>

                <div class="sub-group">
                    <div style="font-size:0.8em; text-transform:uppercase; margin-bottom:5px; color:#bbb;">Velocity Components</div>
                    <div class="math-row">
                        <span class="c-x">Horizontal ($v_x$):</span> 
                        <span id="stat-vx">0.00</span> m/s
                    </div>
                    <div class="math-row">
                        <span class="c-y">Vertical ($v_y$):</span> 
                        <span id="stat-vy">0.00</span> m/s
                    </div>
                    <div class="math-row" style="border-top:1px solid #555; padding-top:4px;">
                        <span class="c-v">Total Speed ($v$):</span> 
                        <span id="stat-vtotal">0.00</span> m/s
                    </div>
                </div>
            </div>

            <!-- Formulas & Predictions -->
            <div class="box" style="background: #34495e;">
                <h3>üìê Predictions</h3>
                
                <!-- Flight Time -->
                <div class="formula-container">
                    <span>Flight Time: $T = \frac{2 v_0 \sin\theta}{g}$</span>
                    <div class="math-row">
                        <span>Predicted Time:</span>
                        <span id="pred-time" class="c-res">0.00 s</span>
                    </div>
                </div>

                <!-- Max Height -->
                <div class="formula-container">
                    <span>Max Height: $H = \frac{(v_0 \sin\theta)^2}{2g}$</span>
                    <div class="math-row">
                        <span>Predicted Height:</span>
                        <span id="pred-height" class="c-res">0.00 m</span>
                    </div>
                </div>

                <!-- Range -->
                <div style="margin-bottom:5px;">
                    <span>Range: $R = \frac{v_0^2 \sin(2\theta)}{g}$</span>
                    <div class="math-row">
                        <span>Predicted Range:</span>
                        <span id="pred-range" class="c-res">0.00 m</span>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <script>
        // --- Setup ---
        const canvas = document.getElementById('simCanvas');
        const ctx = canvas.getContext('2d');
        const zoomDisplay = document.getElementById('zoom-display');
        
        // Physics
        const GRAVITY = 9.81;
        const DT = 0.02; // seconds per frame
        
        let currentEmoji = 'üöÄ';
        let isRunning = false;
        let animationId;
        
        // Simulation State
        let t = 0, x = 0, y = 0;
        let v0 = 50, angle = 45;
        let v0x = 0, v0y = 0;
        let trail = [];

        // Scale (Auto-Zoom)
        let pixelsPerMeter = 1;

        // --- DOM Elements ---
        const ui = {
            vel: document.getElementById('val-velocity'),
            ang: document.getElementById('val-angle'),
            time: document.getElementById('stat-time'),
            x: document.getElementById('stat-x'),
            y: document.getElementById('stat-y'),
            vx: document.getElementById('stat-vx'),
            vy: document.getElementById('stat-vy'),
            vTotal: document.getElementById('stat-vtotal'),
            predH: document.getElementById('pred-height'),
            predR: document.getElementById('pred-range'),
            predT: document.getElementById('pred-time')
        };
        const inputVel = document.getElementById('slider-velocity');
        const inputAng = document.getElementById('slider-angle');

        // --- Init ---
        function init() {
            inputVel.addEventListener('input', updateInput);
            inputAng.addEventListener('input', updateInput);
            updateInput();
        }

        function selectEmoji(e) {
            currentEmoji = e;
            document.querySelectorAll('.emoji-btn').forEach(b => {
                b.classList.remove('selected');
                if(b.innerText === e) b.classList.add('selected');
            });
            draw();
        }

        function updateInput() {
            v0 = parseFloat(inputVel.value);
            angle = parseFloat(inputAng.value);
            
            ui.vel.textContent = v0;
            ui.ang.textContent = angle;

            // PREDICT RESULTS (The Equations)
            let rad = angle * (Math.PI / 180);
            
            // 1. Flight Time: 2*v0*sin(theta) / g
            let time = (2 * v0 * Math.sin(rad)) / GRAVITY;

            // 2. Max Height: (v0 * sin(theta))^2 / 2g
            let maxH = Math.pow(v0 * Math.sin(rad), 2) / (2 * GRAVITY);
            
            // 3. Range: (v0^2 * sin(2*theta)) / g
            let range = (Math.pow(v0, 2) * Math.sin(2 * rad)) / GRAVITY;

            // Update UI
            ui.predT.textContent = time.toFixed(2) + " s";
            ui.predH.textContent = maxH.toFixed(2) + " m";
            ui.predR.textContent = range.toFixed(2) + " m";

            if (!isRunning) {
                // Show initial velocity components when stopped
                let vx = v0 * Math.cos(rad);
                let vy = v0 * Math.sin(rad);
                ui.vx.textContent = vx.toFixed(2);
                ui.vy.textContent = vy.toFixed(2);
                ui.vTotal.textContent = v0.toFixed(2);
                
                calculateZoom(range, maxH);
                draw();
            }
        }

        function calculateZoom(range, height) {
            // Ensure bounds aren't zero
            if (range < 10) range = 10;
            if (height < 10) height = 10;

            const padX = 80;
            const padY = 80;
            const w = canvas.width - padX;
            const h = canvas.height - padY;

            let scaleX = w / range;
            let scaleY = h / height;
            
            // Pick smaller scale to fit both
            pixelsPerMeter = Math.min(scaleX, scaleY);
            if (pixelsPerMeter > 15) pixelsPerMeter = 15; // Cap max zoom

            zoomDisplay.textContent = "Zoom: " + pixelsPerMeter.toFixed(2) + " px/m";
        }

        function startSimulation() {
            if (isRunning) return;
            resetSimulation(false);
            
            // Recalculate physics init
            let rad = angle * (Math.PI / 180);
            v0x = v0 * Math.cos(rad);
            v0y = v0 * Math.sin(rad);
            
            isRunning = true;
            loop();
        }

        function resetSimulation(clearTrail = true) {
            cancelAnimationFrame(animationId);
            isRunning = false;
            t = 0; x = 0; y = 0;
            if (clearTrail) trail = [];
            
            ui.time.textContent = "0.00 s";
            ui.x.textContent = "0.00 m";
            ui.y.textContent = "0.00 m";
            
            updateInput(); // Reset stats to initial state
            draw();
        }

        // --- Core Loop ---
        function loop() {
            if (!isRunning) return;

            t += DT;

            // 1. Position Equations
            x = v0x * t;
            y = (v0y * t) - (0.5 * GRAVITY * t * t);

            // 2. Velocity Equations
            let vx_now = v0x; // Constant
            let vy_now = v0y - (GRAVITY * t); // Changes with time
            
            // Total Velocity = sqrt(vx^2 + vy^2)
            let v_total = Math.sqrt(vx_now*vx_now + vy_now*vy_now);

            // Collision Check
            if (y <= 0) {
                y = 0;
                isRunning = false;
                vy_now = 0;
                vx_now = 0;
                v_total = 0;
                
                // Correction for exact landing spot
                let rad = angle * (Math.PI / 180);
                x = (Math.pow(v0, 2) * Math.sin(2 * rad)) / GRAVITY;
                t = (2 * v0 * Math.sin(rad)) / GRAVITY; // Snap time to exact total
            }

            trail.push({x, y});

            // Update Live Stats
            ui.time.textContent = t.toFixed(2) + " s";
            ui.x.textContent = x.toFixed(2) + " m";
            ui.y.textContent = y.toFixed(2) + " m";
            
            ui.vx.textContent = vx_now.toFixed(2);
            ui.vy.textContent = vy_now.toFixed(2);
            ui.vTotal.textContent = v_total.toFixed(2);

            draw();

            if (isRunning) {
                animationId = requestAnimationFrame(loop);
            } else {
                draw(); // Final frame
            }
        }

        // --- Drawing ---
        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            const padLeft = 40;
            const padBot = 40;
            
            // Transform functions
            const getX = (val) => padLeft + (val * pixelsPerMeter);
            const getY = (val) => (canvas.height - padBot) - (val * pixelsPerMeter);

            // 1. Grid / Axes
            ctx.beginPath();
            ctx.strokeStyle = "rgba(255,255,255,0.4)";
            ctx.lineWidth = 2;
            // X Axis
            ctx.moveTo(0, canvas.height - padBot);
            ctx.lineTo(canvas.width, canvas.height - padBot);
            // Y Axis
            ctx.moveTo(padLeft, 0);
            ctx.lineTo(padLeft, canvas.height);
            ctx.stroke();

            // 2. Trail
            if (trail.length > 1) {
                ctx.beginPath();
                ctx.strokeStyle = "#FF6B6B";
                ctx.lineWidth = 3;
                ctx.setLineDash([5, 5]);
                ctx.moveTo(getX(trail[0].x), getY(trail[0].y));
                for(let p of trail) ctx.lineTo(getX(p.x), getY(p.y));
                ctx.stroke();
                ctx.setLineDash([]);
            }

            // 3. Object
            let cx = getX(x);
            let cy = getY(y);
            
            ctx.save();
            ctx.translate(cx, cy);
            
            // Rotation
            if (isRunning && currentEmoji === 'üöÄ') {
                let vy_curr = v0y - (GRAVITY * t);
                let rot = Math.atan2(-vy_curr, v0x); // Canvas Y is inverted
                ctx.rotate(rot - Math.PI/4);
            }
            
            ctx.font = "30px Arial";
            ctx.textAlign = "center";
            ctx.textBaseline = "middle";
            ctx.fillText(currentEmoji, 0, 0);
            ctx.restore();

            // 4. Velocity Vectors (Visual Arrows)
            if (isRunning || t === 0) {
                let vy_curr = isRunning ? (v0y - GRAVITY * t) : v0y;
                let vx_curr = v0x;
                
                drawArrow(cx, cy, vx_curr, 0, '#be2edd'); // X Vector (Purple)
                drawArrow(cx, cy, 0, vy_curr, '#22a6b3'); // Y Vector (Teal)
            }
        }

        function drawArrow(x, y, vx, vy, color) {
            // Scale arrow length visually so it fits
            const scale = 1.5; 
            const toX = x + (vx * scale);
            const toY = y - (vy * scale); 

            ctx.beginPath();
            ctx.strokeStyle = color;
            ctx.lineWidth = 2;
            ctx.moveTo(x, y);
            ctx.lineTo(toX, toY);
            ctx.stroke();
            
            // Arrowhead
            let angle = Math.atan2(toY - y, toX - x);
            ctx.beginPath();
            ctx.fillStyle = color;
            ctx.moveTo(toX, toY);
            ctx.lineTo(toX - 5 * Math.cos(angle - Math.PI / 6), toY - 5 * Math.sin(angle - Math.PI / 6));
            ctx.lineTo(toX - 5 * Math.cos(angle + Math.PI / 6), toY - 5 * Math.sin(angle + Math.PI / 6));
            ctx.fill();
        }

        init();
    </script>
</body>
</html>